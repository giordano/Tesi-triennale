\chapter{Il problema dei due corpi}
\label{chap:due-corpi}

In questo capitolo affronteremo il \emph{problema dei due corpi}, cioè lo studio
del moto di due corpi, supposti puntiformi, soggetti solamente alla mutua
interazione dovuta a forze che soddisfano il principio di azione e reazione. In
particolare ci occuperemo del \emph{problema di Keplero}, ovvero del caso in cui
l'interazione fra i due corpi è quella gravitazionale che è una forza di tipo
centrale. Il problema sarà risolto usando il formalismo newtoniano e quelli
lagrangiano e hamiltoniano, di questi ultimi daremo una breve
presentazione. Riusciremo a determinare analiticamente le equazioni delle orbite
dei due corpi e a dedurre alcune proprietà del sistema. La risoluzione del
problema di Keplero permette di descrivere, fra le altre cose, il moto di due
corpi celesti, per esempio un pianeta e la sua stella, che sono soggetti solo
alla mutua interazione gravitazionale.

\section{Formalismo newtoniano}
\label{sec:formalismo-newton}

Consideriamo un sistema costituito da due corpi puntiformi, di masse $m_1$ e
$m_2$ e in un fissato sistema di riferimento inerziale indichiamo con $\bm{r}_1$
e $\bm{r}_2$ i rispettivi vettori posizione. %TODO: inserire figura, magari tikz
Per la seconda legge di Newton la forza $\bm{F}_{21}$ che il corpo di massa
$m_1$ esercita sul corpo di massa $m_2$ è data da
\begin{equation}
  \label{eq:f21}
  \bm{F}_{21} = m_2\toder[2]{\bm{r}_2}{t}
\end{equation}
e la forza $\bm{F}_{12}$ che il corpo di massa $m_2$ esercita sull'altro è
\begin{equation}
  \label{eq:f12}
  \bm{F}_{12} = m_1\toder[2]{\bm{r}_1}{t}.
\end{equation}
Assumiamo per ipotesi che queste due forze soddisfino il principio di azione e
reazione nella forma forte:
\begin{equation}
  \label{eq:azione-reazione}
  \bm{F}_{12} = -\bm{F}_{21}.
\end{equation}
Definiamo il vettore \emph{posizione relativa}
\begin{equation}
  \label{eq:posizione-relativa}
  \bm{r}=\bm{r}_2-\bm{r}_1
\end{equation}
e il \emph{centro di massa}
\begin{equation}
  \label{eq:centro-di-massa}
  \bm{r}_\textup{g} = \frac{m_1\bm{r}_1+m_2\bm{r}_2}{m_1+m_2}.
\end{equation}
Dalle equazioni~\eqref{eq:posizione-relativa} e~\eqref{eq:centro-di-massa}
possiamo ricavare $\bm{r}_1$ e $\bm{r}_2$ in funzione di $\bm{r}$ e
$\bm{r}_\textup{g}$:
\begin{subequations}
  \label{eq:r1-r2-posizione-relativa-cdm}
  \begin{align}
    \bm{r}_1 &= \bm{r}_\textup{g} - \frac{m_2}{m_1+m_2}\bm{r} =
    \bm{r}_\textup{g} - \frac{\mu}{m_1}\bm{r},\\
    \bm{r}_2 &= \bm{r}_\textup{g} + \frac{m_1}{m_1+m_2}\bm{r} =
    \bm{r}_\textup{g} + \frac{\mu}{m_2}\bm{r},
  \end{align}
\end{subequations}
in cui abbiamo introdotto la \emph{massa ridotta} $\mu$ definita dalla metà
della media armonica fra $m_1$ e $m_2$
\begin{equation}
  \frac{1}{\mu} = \frac{1}{m_1} + \frac{1}{m_2} \iff \mu=\frac{m_1m_2}{m_1+m_2}.
\end{equation}
Osserviamo che la massa ridotta è sempre minore delle due masse, infatti
\begin{equation}
  \mu =\frac{m_1}{m_1/m_2+1} = \frac{m_2}{1+m_2/m_1}.
\end{equation}
Definiamo inoltre la \emph{massa totale} $M_\textup{T}$ del sistema
\begin{equation}
  M_\textup{T}=m_1+m_2.
\end{equation}
Dalle definizioni di massa ridotta e totale deriva che
$M_\textup{T}\mu=m_1m_2$. Se, per esempio, $m_1\gg m_2$ allora $\mu\simeq m_2$ e
$M_\textup{T}\simeq m_1$. L'equazione del moto del centro di massa può essere
trovata semplicemente calcolando l'accelerazione di $\bm{r}_\textup{g}$:
\begin{equation}
  \toder[2]{\bm{r}_\textup{g}}{t} = \frac{1}{M_\textup{T}}
  \left(
    m_1\toder[2]{\bm{r}_1}{t} + m_2\toder[2]{\bm{r}_2}{t}
  \right) = \frac{\bm{F}_{12}+\bm{F}_{21}}{M_\textup{T}} = \bm{0},
\end{equation}
quindi il centro di massa è in quiete o si muove di moto rettilineo uniforme. A
ogni modo il sistema in cui il centro di massa è a riposo è un sistema inerziale
allora lo scegliamo come nostro nuovo sistema di riferimento e in particolare
fissiamo come origine del sistema la posizione del centro di massa. In questo
nuovo sistema le posizioni delle due masse saranno dunque descritte dai vettori
\begin{subequations}
  \label{eq:r1-r2-nel-cdm}
  \begin{align}
    \bm{r}_1 &= -\frac{\mu}{m_1}\bm{r},\\
    \bm{r}_2 &= \frac{\mu}{m_2}\bm{r}.
  \end{align}
\end{subequations}
Osserviamo che se, per esempio, $m_1\gg m_2$ allora $\bm{r}_1\simeq\bm{0}$, cioè
il corpo più massivo si trova praticamente nel centro di massa, come è logico
aspettarsi dalla definizione di centro di massa. Dividendo ambo i membri
della~\eqref{eq:f21} per $m_2$, ambo i membri della~\eqref{eq:f12} per $m_1$ e
sottraendo membro a membro le equazioni così ottenute ricaviamo
\begin{equation}
  \frac{\bm{F}_{21}}{m_2}-\frac{\bm{F}_{12}}{m_1} = \bm{F}_{21}
  \left(
    \frac{1}{m_2}+\frac{1}{m_1}
  \right) = \frac{\bm{F}_{21}}{\mu} = \toder[2]{(\bm{r}_2-\bm{r}_1)}{t} =
  \toder[2]{\bm{r}}{t}
\end{equation}
in cui abbiamo ricordato che vale il principio di azione e reazione espresso
dalla~\eqref{eq:azione-reazione}. L'equazione precedente può essere riscritta
nella forma
\begin{equation}
  \label{eq:f21-mu}
  \bm{F}_{21}=\mu\toder[2]{\bm{r}}{t}
\end{equation}
da cui possiamo dedurre che il problema del moto relativo dei due corpi si è
ridotto allo studio del moto di un solo corpo fittizio, che chiameremo a volte
\emph{particella relativa}, di massa $\mu$ all'interno del campo generato da un
altro corpo fittizio puntiforme di massa $M_\textup{T}$ e fisso istante per
istante nella posizione di uno dei due corpi. Poiché nel nostro caso abbiamo
definito la posizione relativa come $\bm{r}=\bm{r}_2 - \bm{r}_1$ abbiamo che il
corpo fittizio di massa pari alla massa totale occupa la posizione del corpo
reale di massa $m_1$ e la particella ridotta si trova nella posizione $\bm{r}$
nel sistema di riferimento di $M_\textup{T}$, ovvero la sua posizione coincide
istantaneamente con quella del corpo reale di massa $m_2$.

\subsection{Problema di Keplero}
\label{sec:problema-keplero}

Consideriamo il caso dell'interazione gravitazionale. Se indichiamo con $M$ la
massa del corpo che genera il campo a cui è soggetto un corpo di massa $m$ e con
$\bm{r}$ il vettore diretto dal corpo di massa $M$ verso il corpo di massa $m$
allora la forza $\bm{F}_\textup{G}$ è data da
\begin{equation}
  \label{eq:legge-attrazione}
  \bm{F}_\textup{G} = -\frac{GMm}{r^2}\versor{r},
\end{equation}
in cui $G=\SI{6.674
  28(67)e-11}{\metre\tothe{3}\per\kilogram\per\second\squared}$ è la costante di
gravitazione universale~\cite{codata:costanti}. Si tratta di una forza centrale,
cioè puramente radiale, e il segno meno indica che è sempre attrattiva verso il
centro del campo. Sostituendo la~\eqref{eq:legge-attrazione}
nella~\eqref{eq:f21-mu} abbiamo
\begin{equation}
  \label{eq:forza-mu}
  \bm{F}_{21} = -\frac{GM_\textup{T}\mu}{r^2}\versor{r} =
  -\frac{Gm_1m_2}{r^2}\versor{r} = \mu\toder[2]{\bm{r}}{t}.
\end{equation}

Per una qualsiasi forza di tipo centrale il momento angolare $\bm{l} = \bm{r}
\times \bm{p}$ rispetto al centro della forza è una costante del moto. Infatti
il momento torcente $\bm{\tau}$ di una forza $\bm{F}$ rispetto a un polo $O$ è
definito da
\begin{equation}
  \bm{\tau}= \toder{\bm{l}}{t} = \bm{r}\times\bm{F}
\end{equation}
dove qui con $\bm{r}$ indichiamo il vettore congiungente il polo con il punto di
applicazione della forza. Dunque il momento della forza rispetto alla sorgente
di un campo centrale è nullo, essendo in questo caso $\bm{F}$ diretto lungo
$\bm{r}$, e il momento angolare calcolato rispetto allo stesso polo è costante.

Ritorniamo al problema di Keplero. Abbiamo appena visto che il momento angolare
della particella di massa ridotta rispetto alla posizione di $M_\textup{T}$ è un
integrale primo del moto. Notiamo ora che, per definizione di momento angolare,
i vettori $\bm{r}$ e $\bm{l}\equiv\bm{l}_0$ sono fra loro perpendicolari. La
costanza del vettore $\bm{l}_0$, e in particolare della sua direzione, allora
implica che, nel caso $\bm{l}_0\neq\bm{0}$, il vettore $\bm{r}$, che istante per
istante indica la posizione della particella fittizia $\mu$ nel sistema di
riferimento di $M_\textup{T}$, giace sempre sullo stesso piano perpendicolare a
$\bm{l}_0$. Se invece risulta $\bm{l}_0=\bm{0}$, $\bm{r}$ è parallelo alla
quantità di moto $\bm{p}$ e il moto è unidimensionale. Da qui in seguito
supporremo che il momento angolare $\bm{l}_0$ della particella relativa sia non
nullo.

Dal momento che il moto della particella di massa ridotta si svolge in un piano
possiamo utilizzare le coordinate polari $r,\theta$ per rappresentare la
posizione del corpo nel sistema di riferimento di $M_\textup{T}$. Dalla
meccanica si ricava che per un moto piano la velocità $\dot{\bm{r}}$ e
l'accelerazione $\ddot{\bm{r}}$ del vettore posizione $\bm{r}=r\versor{r}$ sono
date da
\begin{subequations}
  \begin{align}
    \dot{\bm{r}}  &= \dot{r}\versor{r} +
    r\dot{\theta}\versor{\theta}, \label{eq:velocita-polare}\\
    \ddot{\bm{r}} &= (\ddot{r}-r\dot{\theta}^2)\versor{r} + (r\ddot{\theta} +
    2\dot{r}\dot{\theta}) \versor{\theta}.
  \end{align}
\end{subequations}
Usando le coordinate polari l'equazione vettoriale~\eqref{eq:forza-mu} può
allora essere riscritta come due equazioni scalari:
\begin{subequations}
  \begin{gather}
    -\frac{GM_\textup{T}\mu}{r^2} = \mu(\ddot{r} - r\dot{\theta}^2) \iff
    -\frac{GM_\textup{T}}{r^2}=\ddot{r}-r\dot{\theta}^2,
    \label{eq:forza-mu-radiale}\\
    0 = \mu(r\ddot{\theta} +
    2\dot{r}\dot{\theta}). \label{eq:forza-mu-azimutale}
  \end{gather}
\end{subequations}
Dalla~\eqref{eq:forza-mu-azimutale} si trova nuovamente la costanza del modulo
del momento angolare $l_0 = \norm{\bm{l}_0} = \mu r^2\dot{\theta}$, infatti
\begin{equation}
  0 = r\mu(r\ddot{\theta} + 2\dot{r}\dot{\theta}) = \toder{\mu
    r^2\dot{\theta}}{t} = \toder{l_0}{t}.
\end{equation}
L'area differenziale $\dd A$ spazzata dalla particella di massa ridotta che si
sposta di un angolo infinitesimo $\dd\theta$ è espressa da
\begin{equation}
  \dd A = \frac{r\cdot r\dd\theta}{2} = \frac{r^2\dd\theta}{2},
\end{equation}
quindi la velocità areolare $\ltoder{A}{t}$ è
\begin{equation}
  \toder{A}{t} = \frac{1}{2}r^2\dot{\theta} = \frac{1}{2}\frac{l_0}{\mu} =
  \text{costante}.
\end{equation}
Abbiamo così ottenuto la seconda legge di Keplero: \emph{il vettore posizione
  della particella rispetto al centro dell'orbita (o della forza) spazza aree
  uguali in intervalli di tempo uguali}. Osserviamo che per giungere a questo
risultato è stato sufficiente utilizzare la costanza del momento angolare che
deriva a sua volta dal carattere centrale della forza, pertanto questo risultato
è valido per tutte le forze di questo tipo.

\subsection{Equazione dell'orbita}
\label{sec:equazione-dellorbita}

Nel problema di Keplero, vogliamo ora cercare un'espressione esplicita della
coordinata polare $r$ in funzione dell'altra coordinata $\theta$, che a sua
volta dipenderà dal tempo. Per fare ciò è conveniente effettuare la sostituzione
$u=1/r$. Espandiamo le derivate temporali di $r$:
\begin{subequations}
  \begin{align}
    \dot{r} &= \toder{r}{t} = \toder{r}{\theta}\toder{\theta}{t} =
    \toder{(1/u)}{\theta}\dot{\theta} =
    -\frac{\dot{\theta}}{u^2}\toder{u}{\theta}
    = -\frac{l_0}{\mu}\toder{u}{\theta}, \label{eq:derivata1-r}\\
    \begin{split}
      \ddot{r} &= \toder[2]{r}{t} = \toder{}{\theta} \left( \toder{r}{t}
      \right)\toder{\theta}{t} = \toder{}{\theta} \left(
        -\frac{l_0}{\mu}\toder{u}{\theta} \right)\dot{\theta} =
      -\frac{l_0\dot{\theta}}{\mu}\toder[2]{u}{\theta} \\
      &= - \left(
        \frac{l_0}{\mu} \right)^2u^2\toder[2]{u}{\theta}. \label{eq:derivata2-r}
    \end{split}
  \end{align}
\end{subequations}
Sostituendo la~\eqref{eq:derivata2-r} nella~\eqref{eq:forza-mu-radiale} abbiamo
\begin{equation}
  -GM_\textup{T}u^2 = -
  \left(
    \frac{l_0}{\mu}
  \right)^2u^2\toder[2]{u}{\theta} - \frac{l_0^2u^3}{\mu^2}.
\end{equation}
$r$ è la distanza della particella di massa ridotta da $M_\textup{T}$, quindi
assume valori finiti e il suo reciproco $u$ non è mai nullo, allora
nell'equazione precedente possiamo dividere ambo i membri per $u^2$ e otteniamo
\begin{equation}
  \toder[2]{u}{\theta} + u = \frac{GM_\textup{T}\mu^2}{l_0^2}.
\end{equation}
Questa è una equazione differenziale ordinaria lineare del secondo ordine a
coefficienti costanti, chiamata \emph{equazione di Binet}. Per semplificare i
calcoli poniamo
\begin{equation}
  \label{eq:reciproco-semilato}
  \frac{GM_\textup{T}\mu^2}{l_0^2} = \frac{1}{p}
\end{equation}
e così l'integrale generale dell'equazione di Binet è
\begin{equation}
  \label{eq:soluzione-binet}
  u(\theta) = c_0\cos\theta + c_1\sin\theta + \frac{1}{p},
\end{equation}
con $c_0$ e $c_1$ costanti di integrazione. Imponiamo le seguenti condizioni
iniziali
\begin{subequations}
  \label{eq:condizioni-binet}
  \begin{align}
    u(\tilde\omega) &= \frac{1+e}{p},\\
    \toder{u}{\theta}(\tilde\omega) &= 0,
  \end{align}
\end{subequations}
che significano richiedere che il punto $\theta = \tilde\omega$ sia stazionario
per la funzione $u(\theta)$ e che in questo punto la funzione $u$ assuma il
valore $(1+e)/p$. Vedremo più avanti il significato delle grandezze $e$ e
$p$. Osserviamo che riportando queste condizioni alla funzione
$r(\theta)=1/u(\theta)$ abbiamo
\begin{subequations}
  \begin{align}
    r(\tilde\omega) &= \frac{1}{u(\theta)} = \frac{p}{1+e}, \\
    \toder{r}{\theta}(\tilde\omega) &= \toder{(1/u)}{\theta}(\tilde\omega) =
    -\frac{1}{u^2(\tilde\omega)} \toder{u}{\theta}(\tilde\omega) =  0.
  \end{align}
\end{subequations}
Con le condizioni~\eqref{eq:condizioni-binet} le costanti di integrazione
valgono
\begin{subequations}
  \label{eq:costanti-binet}
  \begin{align}
    c_0 &= \frac{e}{p}\cos\tilde\omega, \\
    c_1 &= \frac{e}{p}\sin\tilde\omega,
  \end{align}
\end{subequations}
pertanto la soluzione dell'equazione di Binet~\eqref{eq:soluzione-binet} con le
condizioni~\eqref{eq:condizioni-binet} è
\begin{equation}
  \label{eq:soluzione2-binet}
  u(\theta) = \frac{1}{p}(1 + e\cos\theta\cos\tilde\omega +
  e\sin\theta\sin\tilde\omega) =  \frac{1}{p}(1+e\cos(\theta-\tilde\omega)).
\end{equation}
Ricordando che $r(\theta)=1/u(\theta)$ giungiamo all'equazione polare
dell'orbita della particella relativa nel sistema di riferimento di
$M_\textup{T}$
\begin{equation}
  \label{eq:orbita}
  r(\theta) = \frac{p}{1+e\cos(\theta-\tilde\omega)}.
\end{equation}

\subsection{Classificazione geometrica delle orbite}
\label{sec:class-geom-orbite}

La~\eqref{eq:orbita} è l'equazione polare di una conica con centro nel fuoco o
uno dei fuochi nel caso dell'ellisse. La costante $e$ è chiamata
\emph{eccentricità} della conica, la costante $p$ invece è detta \emph{semilato
  retto}. Entrambe possono assumere valori non negativi. A seconda dei diversi
valori dell'eccentricità le coniche possono essere classificate nel seguente
modo:
\begin{itemize}
\item $0\leq e<1$: \emph{ellisse}. Nel caso particolare $e=0$ si ha una
  \emph{circonferenza};
\item $e=1$: \emph{parabola};
\item $e>1$: \emph{iperbole}.
\end{itemize}
\begin{figure}
  \centering
  \input{Immagini/gnuplot/ellisse}
  \caption[Ellisse in coordinate polari]{Ellisse in coordinate polari. L'origine
    del sistema di riferimento $Oxy$ è la posizione di $M_\textup{T}$ e coincide
    con uno dei fuochi dell'ellisse, $a$ è il semiasse maggiore, $b$ è il
    semiasse minore, $p$ è il semilato retto, $c$ è l'eccentricità lineare. Il
    sistema di riferimento $O'x'y'$ ha origine nel centro dell'ellisse. Nel
    grafico abbiamo posto $a=1$ ed $e=0.7$}
  \label{fig:ellisse}
\end{figure}

Ricordiamo alcune proprietà geometriche delle coniche. Per l'ellisse (vedi la
figura~\ref{fig:ellisse}) il semilato retto $p$ è dato da
\begin{equation}
  \label{eq:semilato-ellisse}
  p = a(1-e^2) = \frac{b^2}{a},
\end{equation}
dove $a$ è il \emph{semiasse maggiore} dell'ellisse e $b$ è il \emph{semiasse
  minore}. Dalla~\eqref{eq:semilato-ellisse} ricaviamo inoltre che
\begin{align}
  b &= a\sqrt{1-e^2},\\
  e &= \sqrt{1-\frac{b^2}{a^2}} =
  \sqrt{1-\frac{p}{a}}. \label{eq:eccentricita-ellisse}
\end{align}
L'\emph{eccentricità lineare} $c$ è la distanza fra il centro dell'ellisse e i
fuochi e risulta
\begin{equation}
  c=\sqrt{a^2-b^2} = ae.
\end{equation}
Il \emph{periapside} è il punto di un'ellisse più vicino a uno dei due fuochi,
l'\emph{apoapside} è il punto dell'ellisse più lontano dallo stesso
fuoco. Osservando la figura~\ref{fig:ellisse} si riconosce che il periapside
rispetto al fuoco $M_\textup{T}$ è raggiunto in corrispondenza di
$\theta=\tilde\omega$ e la distanza del periapside da $M_\textup{T}$ è
$r_\textup{min} = r(\tilde\omega) = a(1-e) = a-c$; l'apoapside è raggiunto per
$\theta=\tilde\omega+\pi$ e la distanza dell'apoapside dallo stesso fuoco è
$r_\textup{max} = r(\tilde\omega+\pi) = a(1+e)= a+c$. Si ottiene il caso
particolare della circonferenza ponendo nelle equazioni precedenti $e=0$, quindi
$p=a=b$, $c=e=0$. Per la parabola sussistono le seguenti relazioni:
\begin{align}
  c &= a,\\
  p &= 2a,
\end{align}
e per l'iperbole:
\begin{align}
  p &= \frac{b^2}{a} = a(e^2-1), \label{eq:semilato-iperbole}\\
  e &= \sqrt{1+\frac{b^2}{a^2}} =
  \sqrt{1+\frac{p}{a}}, \label{eq:eccentricita-iperbole}\\
  b &= a\sqrt{e^2-1}, \\
  c &= \sqrt{a^2+b^2} = ae.
\end{align}
Osserviamo infine che per tutte le coniche risulta $r(\tilde\omega\pm\pi/2)=p$.

Inserendo la~\eqref{eq:reciproco-semilato} nella~\eqref{eq:eccentricita-ellisse}
possiamo ricavare l'eccentricità di un'orbita ellittica legata ai parametri
fisici del sistema
\begin{equation}
  \label{eq:eccentricita-orbita-ellisse}
  e = \sqrt{1-\frac{p}{a}} = \sqrt{1-\frac{l_0^2}{GM_\textup{T}\mu^2a}}.
\end{equation}
Si noti che, poiché $l_0\neq 0$ per ipotesi, si ha $0\leq e<1$, coerentemente
con la classificazione illustrata prima. Nel caso di orbita iperbolica dobbiamo
invece utilizzare la~\eqref{eq:eccentricita-iperbole}:
\begin{equation}
  \label{eq:eccentricita-orbita-iperbole}
  e = \sqrt{1+\frac{p}{a}} = \sqrt{1+\frac{l_0^2}{GM_\textup{T}\mu^2a}}
\end{equation}
e qui risulta $e>1$.

L'unica conica chiusa è l'ellisse, quindi abbiamo ricavato la prima legge di
Keplero che per i pianeti del Sistema Solare afferma: \emph{i pianeti,
  considerati puntiformi, descrivono orbite ellittiche di cui il Sole occupa uno
  dei fuochi}.

\subsection{Calcolo della velocità e applicazioni astronomiche}
\label{sec:velocita}
\begin{figure}
  \centering
  \input{Immagini/gnuplot/velocita}
  \caption[Andamento della velocità in funzione dell'anomalia]{Andamento del
    modulo quadro della velocità della particella relativa in funzione
    dell'angolo $\theta$ nel caso di orbita ellittica, per diversi valori
    dell'eccentricità $e$. In tutte le curve risulta $a=1$ e $\tilde\omega=0$}
  \label{fig:velocita}
\end{figure}
Calcoliamo il modulo quadro della velocità del corpo fittizio di massa ridotta
durante la sua orbita, data dalla~\eqref{eq:velocita-polare}: $v(\theta)^2 =
\norm{\dot{\bm{r}}(\theta)}^2 = \dot{r}^2(\theta) +
r^2(\theta)\dot{\theta}^2$. Ricordando le formule~\eqref{eq:derivata1-r}
e~\eqref{eq:soluzione2-binet} e che $l_0=\mu r^2\dot{\theta}$ abbiamo:
\begin{subequations}
  \begin{align}
    \dot{r}(\theta) &= -\frac{l_0}{\mu}\toder{u}{\theta} = -\frac{l_0}{\mu}
    \left(
      -\frac{1}{p}e\sin(\theta-\tilde\omega)
    \right) = \frac{l_0}{\mu p}e\sin(\theta-\tilde\omega), \\
    r(\theta)\dot{\theta} &= \frac{l_0}{\mu}u = \frac{l_0}{\mu
      p}(1+e\cos(\theta-\tilde\omega)).
  \end{align}
\end{subequations}
Per quanto riguarda il moto ellittico, mettendo insieme le relazioni appena
trovate, la~\eqref{eq:reciproco-semilato} e la~\eqref{eq:orbita} risulta
\begin{equation}
  \label{eq:velocita-ellisse}
  \begin{split}
    v^2(\theta) &= \dot{r}^2(\theta) + r^2(\theta)\dot{\theta}^2 \\
    &= \left(
      \frac{l_0}{\mu p}
    \right)^2(e^2\sin^2(\theta-\tilde\omega) + 1 + 2e\cos(\theta-\tilde\omega) +
    e^2\cos^2(\theta-\tilde\omega)) \\
    &= \left(
      \frac{l_0}{\mu p}
    \right)^2(1+2e\cos(\theta-\tilde\omega)+e^2) \\
    &= \left(
      \frac{l_0}{\mu p}
    \right)^2(2(1+e\cos(\theta-\tilde\omega)) + (e^2-1)) \\
    &= \frac{l_0^2}{\mu^2p}
    \left(
      2\frac{1+e\cos(\theta-\tilde\omega)}{p} - \frac{1-e^2}{p}
    \right) = \frac{l_0^2}{\mu^2 p}
    \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right) \\
    &= \frac{l_0^2}{\mu^2}\frac{GM_\textup{T}\mu^2}{l_0^2}
    \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right) = GM_\textup{T}
    \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right).
  \end{split}
\end{equation}
Questa relazione lega il modulo quadro della velocità alla distanza della
particella relativa da $M_\textup{T}$. Si può osservare in particolare che
$v^2(\theta)$ è lineare in $1/r(\theta)$, quindi il modulo della velocità è
massimo quando la particella relativa si trova nel periapside e vale
\begin{equation}
  v^2(\tilde\omega) = \frac{GM_\textup{T}}{a}\frac{1+e}{1-e}.
\end{equation}
Inoltre il modulo quadro della velocità sarà minimo quando la distanza da
$M_\textup{T}$ è massima, cioè all'apoapside
\begin{equation}
  v^2(\tilde\omega+\pi) = \frac{GM_\textup{T}}{a}\frac{1-e}{1+e}.
\end{equation}
Questi risultati sono in accordo con la seconda legge di Keplero. L'andamento di
$v^2$ in funzione della coordinata $\theta$ è riportato nella
figura~\ref{fig:velocita}.

I calcoli svolti per determinare la velocità nel caso di orbite ellittiche sono
del tutto analoghi a quelli necessari nel caso di orbite paraboliche e
iperboliche, però per le orbite paraboliche $e=1$ quindi
\begin{equation}
  \label{eq:velocita-parabola}
  v^2(\theta) = \frac{2GM_\textup{T}}{r(\theta)},
\end{equation}
mentre per le orbite iperboliche semilato retto ed eccentricità sono legati
dalla~\eqref{eq:semilato-iperbole}, dunque
\begin{equation}
  \label{eq:velocita-iperbole}
  v^2(\theta) = GM_\textup{T}
    \left(
      \frac{2}{r(\theta)} + \frac{1}{a}
    \right).
\end{equation}

\subsubsection{Velocità nella direzione della linea di vista}
\label{sec:velocita-linea-di-vista}

% TODO: controllare per bene i calcoli, non sono molto sicuro che la funzione
% finale sia corretta (in particolare ho l'impressione che alpha cambi segno in
% theta=pi, però poi c'è una strana conca nelle curve con e!=0 dopo theta=pi).
Nelle osservazioni astronomiche di un sistema composto da due corpi celesti non
sempre è possibile misurare direttamente la velocità totale il cui modulo quadro
è dato dalla~\eqref{eq:velocita-ellisse}, ma molto spesso è possibile misurare
la sua componente nella direzione di vista dell'osservatore
$v_\textup{los}$. Supponiamo che l'osservatore guardi il sistema dei due corpi
in moto lungo orbite ellittiche nella direzione dell'asse $\versor{x}$, come
nella figura.
% TODO: aggiungere immagine come la 47 dello Smart e il riferimento
Per calcolare $v_\textup{los}$ facciamo le seguenti osservazioni
geometriche. Chiamiamo $\alpha(\theta)$ l'angolo compreso fra la direzione di
$\versor{r}(\theta)$ e del vettore $\dot{\bm{r}}(\theta) \equiv
\bm{v}(\theta)$. La tangente di questo angolo è data dal rapporto fra la
componente tangenziale $r(\theta)\dot{\theta}$ della velocità e la componente
radiale $\dot{r}(\theta)$:
\begin{equation}
  \tan(\alpha(\theta)) = \frac{r(\theta)\dot{\theta}}{\dot{r}(\theta)} = \frac{1
    + e\cos(\theta-\tilde\omega)}{e\sin(\theta-\tilde\omega)} =
  \cot(\theta-\tilde\omega) + \frac{\csc(\theta-\tilde\omega)}{e}.
\end{equation}
Indichiamo con $\beta(\theta)$ l'angolo compreso fra la direzione del vettore
velocità $\bm{v}(\theta)$ e la linea di vista, nel nostro caso l'asse
$\versor{x}$. Come si vede osservando la figura %TODO riferimento alla figura
abbiamo $\beta(\theta) = \theta + \alpha(\theta)$, quindi il quadrato della
componente della velocità nella direzione della linea di vista è
\begin{equation}
  \begin{split}
    v_\textup{los}^2 &= v^2(\theta)\cos^2(\beta(\theta)) = GM_\textup{T} \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right)\cos^2(\theta + \alpha(\theta)) = \\
    &= GM_\textup{T}
    \left(
      \frac{2(1+e\cos(\theta - \tilde\omega))}{a(1-e^2)} - \frac{1}{a}
    \right)\cos^2(\theta + \alpha(\theta)).
  \end{split}
\end{equation}
\begin{figure}
  \centering
  \input{Immagini/gnuplot/velocita_los}
  \caption[Andamento della velocità nella direzione della di vista]{Andamento
    della velocità lungo la direzione della linea di vista del corpo di massa
    ridotta in funzione dell'angolo $\theta$ nel caso di orbita ellittica. Il
    grafico è stato fatto per gli stessi valori di eccentricità utilizzati nella
    figura~\ref{fig:velocita}, con $a=1$ e $\tilde\omega=0$}
  \label{fig:velocita-los}
\end{figure}
Nella figura~\ref{fig:velocita-los} è riportato l'andamento di
$v_\textup{los}$ in funzione dell'angolo $\theta$.

\subsection{Energia e classificazione energetica delle orbite}
\label{sec:energia-orbite}

Possiamo ora calcolare l'energia meccanica del sistema costituito dai due corpi:
\begin{equation}
  \label{eq:energia}
  \begin{split}
    E &= T + U = \frac{1}{2}m_1\dot{\bm{r}}_1^2 + \frac{1}{2}m_2\dot{\bm{r}}_2^2
    - \frac{GM_\textup{T}\mu}{r(\theta)} \\
    &= \frac{1}{2}m_1
    \left(
      -\frac{\mu}{m_1}\dot{\bm{r}}
    \right)^2 + \frac{1}{2}m_2
    \left(
      \frac{\mu}{m_2}\dot{\bm{r}}
    \right)^2 - \frac{GM_\textup{T}\mu}{r(\theta)} \\
    &= \frac{1}{2}\mu v^2(\theta)
    - \frac{GM_\textup{T}\mu}{r(\theta)} = \frac{1}{2}\mu(\dot{r^2(\theta)} +
    r^2(\theta)\dot{\theta}^2) - \frac{GM_\textup{T}\mu}{r(\theta)}.
  \end{split}
\end{equation}
Per le orbite ellittiche sostituiamo al posto della velocità l'espressione data
dalla~\eqref{eq:velocita-ellisse}
\begin{equation}
  \label{eq:energia-ellisse}
  E = \frac{1}{2}GM_\textup{T}\mu
  \left(
    \frac{2}{r(\theta)} - \frac{1}{a}
  \right) - \frac{GM_\textup{T}\mu}{r(\theta)} = -\frac{GM_\textup{T}\mu}{2a}.
\end{equation}
Per le orbite paraboliche usiamo la~\eqref{eq:velocita-parabola}:
\begin{equation}
  E = \frac{1}{2}\frac{2GM_\textup{T}\mu}{r(\theta)} -
  \frac{GM_\textup{T}\mu}{r(\theta)} = 0.
\end{equation}
Infine per le orbite iperboliche usiamo la~\eqref{eq:velocita-iperbole}:
\begin{equation}
    \label{eq:energia-iperbole}
  E = \frac{1}{2}GM_\textup{T}\mu
  \left(
    \frac{2}{r(\theta)} + \frac{1}{a}
  \right) - \frac{GM_\textup{T}\mu}{r(\theta)} = \frac{GM_\textup{T}\mu}{2a}.
\end{equation}
Dunque in tutti i casi l'energia è una costante del moto e dipende solo dalle
masse $m_1$ e $m_2$ dei due corpi, attraverso $M_\textup{T}$ e $\mu$, e dal
semiasse maggiore dell'ellisse descritta dal loro moto relativo, ma non
dall'eccentricità di questa. Naturalmente il fatto che l'energia si conserva non
deve sorprendere perché abbiamo supposto per ipotesi che il sistema fosse
isolato e che l'unica forza agente fosse quella
gravitazionale.

Dalla~\eqref{eq:energia} possiamo osservare che il moto relativo è equivalente a
un moto unidimensionale lungo la direzione radiale e con un \emph{potenziale
  efficace}
\begin{figure} %TODO: scegliere valori migliori per il grafico
  \centering
  \input{Immagini/gnuplot/potenziale_efficace}
  \caption[Andamento del potenziale efficace in funzione della distanza dal
  centro del campo]{Andamento qualitativo del potenziale efficace della
    particella $\mu$ nel problema di Keplero in funzione della distanza dal
    centro del campo. Il grafico rappresenta la funzione $k_1/r^2-k_2/r$, con
    $k_1$ e $k_2$ costanti positive scelte arbitrariamente}
  \label{fig:potenziale-efficace}
\end{figure}
\begin{equation}
  U_\textup{eff}(r(\theta)) = \frac{1}{2}\mu r^2(\theta)\dot{\theta}^2 -
  \frac{GM_\textup{T}\mu}{r(\theta)} = \frac{1}{2}\frac{l_0^2}{\mu r^2(\theta)} -
  \frac{GM_\textup{T}\mu}{r(\theta)}.
\end{equation}
Il termine $l_0/(2\mu r^2(\theta))$ è chiamato \emph{potenziale
  centrifugo}. Nella figura~\ref{fig:potenziale-efficace} è riportato il grafico
della curva del potenziale efficace. In $r=r_0=l_0/(GM_\textup{T}\mu^2)$ si ha
un punto di minimo per $U_\textup{eff}$ e risulta $U_\textup{eff}(r_0) =
-G^2M_\textup{T}^2\mu^3/(2l_0^2)$. La differenza fra l'energia e la curva di
$U_\textup{eff}$ dà $\mu\dot{r}^2/2$, quindi il moto è ammesso solo in quelle
regioni in cui $E-U_\textup{eff}\geq 0$, cioè:
\begin{enumerate}
\item se $E = E_0 = G^2M_\textup{T}^2\mu^3/(2l_0^2)$ risulta $\dot{r}=0$, cioè
  $r(t) = r_0 = \text{costante}$. L'orbita è dunque circolare e il moto
  circolare uniforme con pulsazione $\omega_0 = l_0/(\mu r_0^2)$;
\item se $E = E_1 \in \mathopen{]}E_0,0\mathclose{[}$, il moto è limitato fra le
  distanze apsidali $r_\textup{min}$ e $r_\textup{max}$ e l'orbita è un'ellisse;
\item se $E = E_2 \geq 0$ il moto è limitato inferiormente ma non
  superiormente. Se $E_2 = 0$ l'orbita descritta è una parabola, se $E_2>0$ si
  ha un'iperbole.
\end{enumerate}

Inserendo la~\eqref{eq:energia-ellisse}
nella~\eqref{eq:eccentricita-orbita-ellisse} e la~\eqref{eq:energia-iperbole}
nella~\eqref{eq:eccentricita-orbita-iperbole} abbiamo che sia per orbite
ellittiche sia per orbite iperboliche sussiste la seguente relazione fra energia
ed eccentricità dell'orbita
\begin{equation}
  e = \sqrt{1+\frac{2El_0^2}{G^2M_\textup{T}^2\mu^3}}.
\end{equation}
Si noti che questa relazione è valida anche per le orbite paraboliche perché in
questo caso l'energia è nulla e l'eccentricità vale $1$.

Il corpo fittizia $M_\textup{T}$ esercita un'attrazione sulla particella
relativa, tuttavia la presenza del potenziale centrifugo non
nullo\footnote{Ricorda che abbiamo supposto per ipotesi che sia $l_0\neq 0$.}
impedisce che questa possa cadere nel centro della forza se il campo generato è
quello gravitazionale. Infatti abbiamo
\begin{equation}
  0\leq \frac{1}{2}\mu\dot{r}^2 = E - U_\textup{eff}(r) = E -
  \frac{1}{2}\frac{l_0^2}{\mu r^2} - \frac{GM_\textup{T}\mu}{r}
\end{equation}
che può essere riscritta come
\begin{equation}
  \frac{1}{2}\frac{l_0^2}{\mu} + GM_\textup{T}\mu r \leq Er^2
\end{equation}
e facendo il limite per $r \to 0$ abbiamo
\begin{equation}
  \frac{1}{2}\frac{l_0^2}{\mu} \leq 0,
\end{equation}
ma questo non è impossibile.

\subsubsection{Variazioni dell'energia}
\label{sec:variazioni energia}

Vogliamo vedere come varia il semiasse maggiore di un'orbita ellittica della
particella di massa ridotta in funzione dell'energia. Per fare ciò differenziamo
la~\eqref{eq:energia-ellisse} rispetto ad $a$
\begin{equation}
  \dd E = \frac{GM_\textup{T}\mu}{2a^2}\dd a.
\end{equation}
Osserviamo che $\dd E$ e $\dd a$ hanno lo stesso segno, quindi se l'energia
aumenta allora aumenterà anche il semiasse maggiore, se l'energia diminuisce lo
stesso farà $a$. Questo risultato ha importanti conseguenze astronomiche. Se un
sistema binario di corpi celesti perde energia per qualche motivo, cioè
l'energia diventa ancora più negativa, il semiasse maggiore diminuirà rendendo
il sistema più legato, al contrario se il sistema acquista energia, cioè questa
diventa meno negativa, il semiasse maggiore aumenterà e il sistema diventerà
meno legato. Al limite, se l'energia diventa nulla o positiva il sistema non
sarà più legato.

Consideriamo ora il caso in cui il sistema sta perdendo energia a causa della
diminuzione della massa di uno dei corpi, per esempio $m_1$. Supponiamo che i
due corpi descrivano orbite ellittiche e indichiamo la variazione della massa di
$m_1$ con $\Delta M = m_1 - m_\textup{R}$, dove $m_\textup{R}$ è la massa
residua del corpo. Facciamo l'ipotesi semplificatrice, ma non del tutto
corretta, che dopo la perdita di massa da parte di $m_1$ la velocità
\begin{equation}
  v^2(\theta) = G(m_1 + m_2)
  \left(
    \frac{2}{r(\theta)} - \frac{1}{a}
  \right)
\end{equation}
resti invariata, così come il semiasse maggiore $a$ dell'orbita. In questo modo
l'energia finale del sistema sarà, avendo posto $M'_\textup{T}=m_\textup{R}+m_2$
e $\mu' = m_\textup{R}m_2/(m_\textup{R} + m_2)$
\begin{equation}
  \begin{split}
    E' &= \frac{1}{2}\mu'v^2 - \frac{GM'_\textup{T}\mu'}{r(\theta)} \\
    &= \frac{1}{2}\frac{m_\textup{R}m_2}{m_\textup{R} + m_2}G(m_1 + m_2)
    \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right) - G\frac{m_\textup{R}m_2}{r(\theta)} \\
    &= Gm_\textup{R}m_2
    \left(
      \frac{m_1 + m_2}{2(m_\textup{R} + m_2)}
      \left(
        \frac{2}{r(\theta)} - \frac{1}{a}
      \right) - \frac{1}{r(\theta)}
    \right).
  \end{split}
\end{equation}
Affinché il sistema rimanga legato anche dopo la perdita di massa del corpo
$m_1$ deve risultare ancora $E' < 0$, invece il sistema si distruggerà se $E'
\geq 0$, cioè
\begin{equation}
  \begin{split}
    0 &\leq \frac{m_1 + m_2}{2(m_\textup{R} + m_2)}
    \left(
      \frac{2}{r(\theta)} - \frac{1}{a}
    \right) - \frac{1}{r(\theta)} \\
    &= \frac{1}{r(\theta)}
    \left(
      \frac{m_1 + m_2}{m_\textup{R} + m_2} - 1
    \right) - \frac{m_1 + m_2}{2a(m_\textup{R} + m_2)} \\
    &= \frac{1}{r(\theta)}\frac{m_1 + m_2 - m_\textup{R} - m_2}{m_\textup{R} +
      m_2} - \frac{m_1 + m_2}{2a(m_\textup{R} + m_2)} \\
    &= \frac{1}{r(\theta)}\frac{\Delta M}{m_\textup{R} +
      m_2} - \frac{m_1 + m_2}{2a(m_\textup{R} + m_2)},
  \end{split}
\end{equation}
da cui
\begin{equation}
  \Delta M \geq \frac{1}{2}\frac{r(\theta)}{a}(m_1 + m_2).
\end{equation}
Per stimare il valore minimo di $\Delta M$ per il quale il sistema si distrugge
scegliamo di valutare $r(\theta)$ al periapside, cioè in $\theta =
\tilde\omega$, perché quando l'orbita è ancora chiusa il sistema è maggiormente
legato in questo punto, pertanto
\begin{equation}
    \Delta M \geq \frac{1}{2}\frac{r(\tilde\omega)}{a}(m_1 + m_2) =
    \frac{1}{2}(1 - e)(m_1 + m_2).
\end{equation}
Da questa relazione possiamo dedurre che all'aumentare dell'eccentricità
iniziale $e$ diventa necessaria una minor quantità di massa persa da parte del
corpo $m_1$ affinché il sistema non sia più stabile. Inoltre nel caso di orbite
originali circolari, cioè $e=0$, il sistema non potrà distruggersi se il corpo
che perde massa è il più piccolo dei due perché non può essere soddisfatta
la condizione $\Delta M \geq (m_1 + m_2)/2$.

\section{Formalismo lagrangiano e hamitoniano}
\label{sec:formalismo-lagrange}

\subsection{Introduzione alla meccanica lagrangiana e hamiltoniana}
\label{sec:intro-lagrange}

La meccanica newtoniana descrive l'evoluzione di un sistema fisico attraverso la
\emph{seconda legge del moto di Newton}. Nella seconda metà del diciottesimo
secolo il fisico e matematico francese di origine italiana Joseph-Louis Lagrange
propose una formulazione alternativa della meccanica che ora presentiamo
brevemente.

Un sistema fisico composto da $N$ particelle è descritto nello spazio da $3N$
coordinate, ma se il sistema è soggetto a dei vincoli queste $3N$ grandezze
potrebbero essere fra loro legate. Se i vincoli sono olonomi\footnote{Un vincolo
  si dice \emph{olonomo} se è esprimibile sotto forma di un'equazione del tipo
  $f(\bm{r}_1,\dots,\bm{r}_N,t)=0$, dove le $\bm{r}_i$ rappresentano le
  posizioni delle $N$ particelle all'istante $t$.} ed espressi da $k$ equazioni
allora è possibile introdurre $n=3N-k$ coordinate indipendenti che indichiamo
con $q_1,\dots,q_n$ e che determinano univocamente il sistema tenendo conto dei
vincoli. Le $q_i$ sono dette \emph{coordinate generalizzate} o
\emph{lagrangiane}, non hanno necessariamente le dimensioni di una lunghezza e
la loro scelta non è univoca; $n$, il numero di grandezze indipendenti, è
chiamato \emph{numero di gradi di libertà}. D'ora in poi indicheremo per brevità
con $\bm{q} = (q_1,\dots,q_n)$ l'insieme delle $n$ coordinate generalizzate e
con $\dot{\bm{q}} = (\dot{q}_1,\dots,\dot{q}_n)$ l'insieme delle \emph{velocità
  generalizzate} sebbene, come già osservato, a rigore non è detto che tutte
queste grandezze abbiano la stessa dimensione fisica. Definiamo la
\emph{funzione di Lagrange} o \emph{lagrangiana}
$\mathcal{L}(\bm{q},\dot{\bm{q}},t)$
\begin{equation}
  \mathcal{L}(\bm{q},\dot{\bm{q}},t) = T(\bm{q},\dot{\bm{q}},t) -
  U(\bm{q},\dot{\bm{q}},t)
\end{equation}
dove $T(\bm{q},\dot{\bm{q}},t)$ è l'\emph{energia cinetica} del sistema e
$U(\bm{q},\dot{\bm{q}},t)$ è l'energia potenziale, chiamata \emph{potenziale
  generalizzato} quando dipende dalle velocità $\dot{\bm{q}}$. Nella meccanica
lagrangiana l'evoluzione del sistema è descritto dalle $n$ equazioni
differenziali del secondo ordine chiamate \emph{equazioni di Lagrange}
\begin{equation}
  \label{eq:lagrange}
  \toder{}{t}
  \left(
    \parder{\mathcal{L}}{\dot{q}_i}
  \right) = \parder{\mathcal{L}}{q_i} \qquad (i=1,2,\dots,n).
\end{equation}
La grandezza
\begin{equation}
  p_i = \parder{\mathcal{L}}{\dot{q}_i}
\end{equation}
è chiamata \emph{momento coniugato} alla variabile generalizzata $q_i$.
Dalla~\eqref{eq:lagrange} si vede subito che se la lagrangiana non dipende
esplicitamente dalla coordinata generalizzata $q_i$ allora il corrispondente
momento coniugato è una costante del moto. In questo caso la $q_i$ si dice
\emph{ciclica}.

Nella prima metà del 1800 il fisico e matematico irlandese William Rowan
Hamilton riformulò la meccanica lagrangiana. Nel formalismo lagrangiano le
variabili fondamentali sono le coordinate generalizzate $\bm{q}$ che
costituiscono lo \emph{spazio delle configurazioni}, invece nel formalismo
hamitoniano si passa alle \emph{variabili canoniche} $(\bm{q},\bm{p})$ che
formano lo \emph{spazio delle fasi}. La \emph{funzione di Hamilton} o
\emph{hamiltoniana} è la funzione definita dalla seguente trasformazione di
Legendre della lagrangiana
\begin{equation}
  \mathcal{H}(\bm{q},\bm{p},t) = \sum_{i=1}^n\dot{q}_ip_i -
  \mathcal{L}(\bm{q},\dot{\bm{q}},t).
\end{equation}
In alcuni contesti l'hamiltoniana è chiamata anche \emph{funzione energia}. Nel
caso in cui l'energia cinetica è una funzione omogenea di secondo grado delle
velocità generalizzate $\dot{q}_i$ e il potenziale non dipende da esse allora
l'hamiltoniana coincide con l'energia meccanica totale del sistema $E = T +
U$. Se inoltre l'hamiltoniana non dipende esplicitamente dal tempo l'energia del
sistema è un integrale primo del moto. Le equazioni del moto in questo
formalismo sono date dalle seguenti $2n$, per $i=1,2,\dots,n$, equazioni
differenziali del primo ordine, chiamate \emph{equazioni di Hamilton}
\begin{subequations}
  \begin{align}
    \parder{\mathcal{H}}{p_i} &= \dot{q}_i, \\
    \parder{\mathcal{H}}{q_i} &= -\dot{p}_i.
  \end{align}
\end{subequations}

Maggiori dettagli su questi formalismi possono essere trovati in qualsiasi libro
di meccanica classica come~\cite{goldstein:meccanica} e~\cite{landau:meccanica}.

\subsection{Risoluzione del problema dei due corpi}
\label{sec:risoluzione-lagrange}

%TODO: mettere un riferimento alla figura che inserirò nel paragrafo sul
%formalismo newtoniano e riferirsi alle grandezze presenti in quella figura. Ora
%ricopio l'introduzione della sezione precedente, ricordati di cambiare dopo che
%ci sarà la figura!
Consideriamo un sistema costituito da due corpi puntiformi, di masse $m_1$ e
$m_2$ e in un fissato sistema di riferimento inerziale indichiamo con $\bm{r}_1$
e $\bm{r}_2$ i rispettivi vettori posizione. Come fatto nel
paragrafo~\ref{sec:formalismo-newton} introduciamo anche i vettori posizione
relativa e posizione del centro di massa dati rispettivamente
dalla~\eqref{eq:posizione-relativa} e dalla~\eqref{eq:centro-di-massa} e quindi
i vettori di posizione sono legati a questi dalle
relazioni~\eqref{eq:r1-r2-posizione-relativa-cdm}. Le quantità di moto dei due
corpi che costituiscono il sistema sono
\begin{subequations}
  \begin{align}
    \bm{p}_1 &= \toder{m_1\bm{r}_1}{t} = m_1\dot{\bm{r}}_1, \\
    \bm{p}_2 &= \toder{m_2\bm{r}_2}{t} = m_2\dot{\bm{r}}_2
  \end{align}
\end{subequations}
Supponiamo che le forze con cui interagiscono i due corpi derivino da un unico
potenziale $U=U(\bm{r})$ dipendente solo dalla posizione relativa fra i due
corpi, dunque la lagrangiana del sistema è data da
\begin{equation}
  \label{eq:lagrangiana-due-corpi}
  \begin{split}
    \mathcal{L} &= T - U = \frac{1}{2}m_1\dot{\bm{r}}_1^2 +
    \frac{1}{2}m_2\dot{\bm{r}}_2^2 - U(\bm{r}) \\
    &= \frac{1}{2}m_1
    \left(
      \dot{\bm{r}}_\textup{g} -
      \frac{\mu}{m_1}\dot{\bm{r}}
    \right)^2 + \frac{1}{2}m_2
    \left(
      \dot{\bm{r}}_\textup{g} +
      \frac{\mu}{m_2}\dot{\bm{r}}
    \right)^2 - U(\bm{r}) \\
    &= \frac{1}{2}M_\textup{T}\dot{\bm{r}}_\textup{g}^2 +
    \frac{1}{2}\mu\dot{\bm{r}}^2 - U(\bm{r}),
\end{split}
\end{equation}
dove $M_\textup{T}=m_1+m_2$ e $\mu=m_1m_2/(m_1+m_2)$ sono, rispettivamente, la
massa totale e la massa ridotta già introdotte nel
paragrafo~\ref{sec:formalismo-newton}. I momenti coniugati alle coordinate
$\bm{r}_\textup{g}$ e $\bm{r}$ sono
\begin{subequations}
  \begin{align}
    \bm{p}_\textup{g} &= \parder{\mathcal{L}}{\dot{\bm{r}}_\textup{g}} =
    M_\textup{T}\dot{\bm{r}}_\textup{g} = m_1\dot{\bm{r}}_1+m_2\dot{\bm{r}}_2 =
    \bm{p}_1 + \bm{p}_2, \\
    \bm{p} &= \parder{\mathcal{L}}{\dot{\bm{r}}} = \mu\dot{\bm{r}} =
    \frac{m_2\bm{p}_1 + m_1\bm{p}_2}{m_1 + m_2}. \label{eq:momento-relativo}
  \end{align}
\end{subequations}
$\bm{p}_\textup{g}$ è il \emph{momento totale}, $\bm{p}$ il \emph{momento
  relativo}. Osserviamo che
\begin{equation}
  \frac{\bm{p}}{\mu} = \frac{\bm{p}_1}{m_1} + \frac{\bm{p}_2}{m_2}.
\end{equation}
La coordinata $\bm{r}_\textup{g}$ è ciclica nella
lagrangiana~\eqref{eq:lagrangiana-due-corpi} quindi il momento totale
$\bm{p}_\textup{g}=M_\textup{T}\dot{\bm{r}}_\textup{g}$ è una costante del moto:
il centro di massa si muove di moto rettilineo uniforme oppure è in quiete,
comunque il sistema di riferimento in cui esso è a riposo è inerziale. Scegliamo
allora come nostro sistema di riferimento uno in cui il centro di massa è in
quiete, cioè $\dot{\bm{r}}_\textup{g} = \bm{0}$, e così la lagrangiana diventa
\begin{equation}
  \label{eq:lagrangiana2-due-corpi}
  \mathcal{L} = \frac{1}{2}\mu\dot{\bm{r}}^2 - U(\bm{r}).
\end{equation}
Il primo termine di questa lagrangiana è l'energia cinetica di un corpo fittizio
di massa $\mu$ e posizione $\bm{r}$ rispetto all'origine del sistema di
riferimento. Il vettore $\bm{r}$ svolge dunque il ruolo di coordinate
generalizzate e il numero di grandezze indipendenti che lo individuano è uguale
al numero di gradi di libertà del sistema.  L'equazione di Lagrange per la
coordinata $\bm{r}$ è
\begin{equation}
  \toder{\bm{p}}{t} = -\toder{U(\bm{r})}{\bm{r}} \iff \mu\toder[2]{\bm{r}}{t} =
  -\nabla U(\bm{r}),
\end{equation}
cioè la~\eqref{eq:f21-mu} ricordando che $\bm{F}_{21} = -\nabla U(\bm{r})$
perché abbiamo supposto che le forze agenti nel sistema derivino dall'unico
potenziale $U$.

L'energia cinetica $T$ è una funzione omogenea di secondo grado della velocità
generalizzata $\dot{\bm{r}}$ mentre l'energia potenziale $U$ non dipende da
essa, quindi l'hamiltoniana del sistema rappresenta esattamente l'energia
meccanica totale
\begin{equation}
  \mathcal{H} = \bm{p}\cdot\dot{\bm{r}} - \mathcal{L} = \frac{\bm{p}^2}{2\mu} +
  U(\bm{r}).
\end{equation}
L'hamiltoniana non dipende esplicitamente dal tempo, pertanto l'energia del
sistema è una costante del moto. Le equazioni di Hamilton per la variabili
canoniche $(\bm{r},\bm{p})$ sono
\begin{subequations}
  \begin{align}
    \parder{\mathcal{H}}{\bm{p}} &= \dot{\bm{r}} \iff \frac{\bm{p}}{\mu} =
    \dot{\bm{r}}, \\
    \parder{\mathcal{H}}{\bm{r}} &= -\dot{\bm{p}} \iff \toder{\bm{p}}{t} =
    -\toder{U(\bm{r})}{\bm{r}} = -\nabla U(\bm{r}).
  \end{align}
\end{subequations}
La prima equazione di Hamilton è equivalente alla~\eqref{eq:momento-relativo},
la seconda è equivalente alla~\eqref{eq:f21-mu}.

Supponiamo ora che il potenziale dipenda in particolare dalla distanza $r$ fra i
due corpi e non dalla direzione del vettore $\bm{r}$, cioè $U=U(r)$. Questo
comporta, per l'equazione di Lagrange o per la seconda equazione di Hamilton,
che la forza che agisce sulla particella relativa è centrale quindi, come
abbiamo visto nel paragrafo~\ref{sec:problema-keplero}, il vettore momento
angolare $\bm{l}_0$ è un integrale primo e il moto si svolge in un piano. Allora
il sistema ha due gradi di libertà e possiamo riscrivere la
lagrangiana~\eqref{eq:lagrangiana2-due-corpi} nelle coordinate generalizzate
polari $r,\theta$
\begin{equation}
  \mathcal{L} = \frac{1}{2}\mu(\dot{r}^2+r^2\dot{\theta}^2) - U(r).
\end{equation}
La coordinata $\theta$ è ciclica quindi il suo momento coniugato
\begin{equation}
  p_\theta = \parder{\mathcal{L}}{\dot{\theta}} = \mu r^2\dot{\theta} = l_0
\end{equation}
è una costante del moto. Abbiamo così trovato nuovamente che il modulo del
vettore momento angolare è costante e ricordiamo che grazie a questo risultato
nel paragrafo~\ref{sec:problema-keplero} siamo stati in grado di dimostrare la
seconda elegge di Keplero. L'equazione di Lagrange per la coordinata $r$ è
\begin{equation}
  \label{eq:eq-lagrange-due-corpi}
  \mu\ddot{r} = \mu r\dot{\theta}^2 - \parder{U(r)}{r}.
\end{equation}
Se il potenziale è quello di attrazione gravitazionale fra la particella
relativa e $M_\textup{T}$, cioè
\begin{equation}
  \label{eq:potenziale-gravitazionale}
  U(r) = -\frac{GM_\textup{T}\mu}{r},
\end{equation}
allora l'equazione di Lagrange~\eqref{eq:eq-lagrange-due-corpi} diventa
l'equazione del moto~\eqref{eq:forza-mu-radiale} e si può ricavare l'equazione
dell'orbita~\eqref{eq:orbita} nello stesso modo. Il momento coniugato alla
coordinata $r$ è
\begin{equation}
  p = \parder{\mathcal{L}}{\dot{r}} = \mu\dot{r}.
\end{equation}
L'hamiltoniana in coordinate polari e con il potenziale
gravitazionale~\eqref{eq:potenziale-gravitazionale} è
\begin{equation}
  \begin{split}
    \mathcal{H} &= p\dot{r} + p_\theta\dot{\theta} - \mathcal{L} =
    \frac{1}{2}\mu(\dot{r}^2+r^2\dot{\theta}^2) - \frac{GM_\textup{T}\mu}{r} \\
    &= \frac{1}{2}\mu\dot{r}^2 + \frac{1}{2}\frac{l_0^2}{\mu r^2} -
    \frac{GM_\textup{T}\mu}{r},
  \end{split}
\end{equation}
cioè l'espressione dell'energia data dalla~\eqref{eq:energia}.

Naturalmente usando il formalismo lagrangiano e hamiltoniano siamo giunti agli
stessi risultati trovati usando il formalismo newtoniano.

\section{Orbite dei due corpi nel problema di Keplero}
% TODO: inventarsi un titolo decente
\label{sec:orbite-corpi}

Nel paragrafo~\ref{sec:equazione-dellorbita} abbiamo ricavato
l'equazione~\eqref{eq:orbita} dell'orbita della particella di massa ridotta per
il problema di Keplero e nel paragrafo~\ref{chap:due-corpi} abbiamo visto che
i vettori posizione $\bm{r}_1$ e $\bm{r}_2$, nel sistema di riferimento del
centro di massa, delle particelle di massa rispettivamente $m_1$ e $m_2$ sono
legati al vettore $\bm{r}$, che individua la posizione della particella
relativa, dalle relazioni~\eqref{eq:r1-r2-nel-cdm}. Allora sostituendo
la~\eqref{eq:orbita} nelle~\eqref{eq:r1-r2-nel-cdm} troviamo che le orbite dei
due corpi nel sistema di riferimento del centro di massa sono
\begin{figure}
  \centering
  \input{Immagini/gnuplot/orbite_ellittiche}
  \caption[Orbite dei due corpi]{Nella figura di destra sono riportate le orbite
    ellittiche dei due corpi nel sistema di riferimento del centro di
    massa. Nella figura di sinistra è rappresentata l'orbita della particella
    relativa nel sistema di riferimento con origine nel corpo di massa
    $m_1$. Abbiamo posto $m_1=5$ e $m_2=1$ in unità arbitrarie, i parametri
    delle ellissi sono $a=1$ ed $e=0.8$. Le due figure non sono nella stessa
    scala}
  \label{fig:orbite-ellittiche}
\end{figure}
\begin{subequations}
  \begin{align}
    r_1(\theta) &= -\frac{\mu}{m_1}r(\theta) =
    -\frac{\mu}{m_1}\frac{p}{1+e\cos(\theta - \tilde\omega)},\\
    r_2(\theta) &= \frac{\mu}{m_2}r(\theta) =
    \frac{\mu}{m_2}\frac{p}{1+e\cos(\theta - \tilde\omega)}.
  \end{align}
\end{subequations}
Nella figura~\ref{fig:orbite-ellittiche} mostriamo le orbite dei due corpi e del
corpo di massa ridotta nel caso di orbite ellittiche. Come si può osservare,
entrambi i corpi ruotano intorno al centro di massa ma mentre il corpo più
massivo, nell'esempio in figura $m_1$, rimane vicino a questo, il corpo meno
massivo descrive orbite più larghe. Dalle
relazioni~\eqref{eq:r1-r2-posizione-relativa-cdm} si vede inoltre che il centro
di massa giace sempre sulla congiungente $\bm{r}$ dei due corpi, quindi $m_1$ e
$m_2$ sono sempre opposti rispetto al centro di massa durante il loro moto
orbitale.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../tesi"
%%% End: 
